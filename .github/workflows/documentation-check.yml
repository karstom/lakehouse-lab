# .github/workflows/docs-check.yml
name: Documentation Check
on: [push, pull_request]
jobs:
  docs:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v4
      - name: Check for broken links
        uses: gaurav-nelson/github-action-markdown-link-check@v1
      - name: Validate README structure
        run: |
          echo "Validating README.md structure..."
          grep -q "Quick Start" README.md
          grep -q "Architecture" README.md
          grep -q "Troubleshooting" README.md
          grep -q "Backup & Data Protection" README.md
          
          # Check for learning-focused messaging
          if ! grep -q "learning" README.md; then
            echo "‚ùå Missing learning-focused messaging in README"
            exit 1
          fi
          
          echo "‚úÖ README structure validated"
          
      - name: Validate documentation completeness
        run: |
          echo "Checking for required documentation files..."
          
          required_docs=(
            "QUICKSTART.md"
            "INSTALLATION.md" 
            "CONFIGURATION.md"
            "CHANGELOG.md"
            "TESTING.md"
            "ICEBERG.md"
          )
          
          for doc in "${required_docs[@]}"; do
            if [ ! -f "$doc" ]; then
              echo "‚ùå Missing required documentation: $doc"
              exit 1
            fi
            echo "‚úÖ Found: $doc"
          done
          
      - name: Validate backup documentation
        run: |
          echo "Validating backup system documentation..."
          
          # Check README has backup section
          if ! grep -q "üíæ Backup & Data Protection" README.md; then
            echo "‚ùå Backup section missing from README"
            exit 1
          fi
          
          # Check INSTALLATION has backup setup
          if ! grep -q "Post-Installation: Backup Setup" INSTALLATION.md; then
            echo "‚ùå Backup setup missing from INSTALLATION"
            exit 1
          fi
          
          # Check CONFIGURATION has backup config
          if ! grep -q "üíæ Backup Configuration" CONFIGURATION.md; then
            echo "‚ùå Backup configuration missing from CONFIGURATION"
            exit 1
          fi
          
          # Check CHANGELOG has v2.1.0 backup features
          if ! grep -q "üíæ Comprehensive Backup & Restore System" CHANGELOG.md; then
            echo "‚ùå v2.1.0 backup features missing from CHANGELOG"
            exit 1
          fi
          
          echo "‚úÖ Backup documentation complete"
          
      - name: Validate version consistency
        run: |
          echo "Checking version consistency across documentation..."
          
          # Check that v2.1.0 is mentioned in key files
          version_files=("README.md" "QUICKSTART.md" "INSTALLATION.md" "CONFIGURATION.md")
          
          for file in "${version_files[@]}"; do
            if ! grep -q "2.1.0" "$file"; then
              echo "‚ùå Version 2.1.0 not found in $file"
              exit 1
            fi
          done
          
          echo "‚úÖ Version consistency validated"
